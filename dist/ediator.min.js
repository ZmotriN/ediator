class Ediator{input=null;parent=null;content=null;settings={};classes={editor:"ediator",content:"ediator__content",actionbar:"ediator__actionbar",button:"ediator__actionbar__button",selected:"ediator__actionbar__button--selected"};defaultSettings={className:"",separator:"p",value:"",input:"",styleWithCSS:!1,onChange:null,actions:["bold","underline","italic","superscript","subscript"]};defaultActions={bold:{icon:"<b>B</b>",title:"Bold",state:()=>this.queryState("bold"),result:()=>this.exec("bold")},italic:{icon:"<i>I</i>",title:"Italic",state:()=>this.queryState("italic"),result:()=>this.exec("italic")},underline:{icon:"<u>U</u>",title:"Underline",state:()=>this.queryState("underline"),result:()=>this.exec("underline")},superscript:{icon:"<sup>x</sup>",title:"Superscript",state:()=>this.queryState("superscript"),result:()=>this.exec("superscript")},subscript:{icon:"<sub>y</sub>",title:"Subscript",state:()=>this.queryState("subscript"),result:()=>this.exec("subscript")},strikethrough:{icon:"<strike>S</strike>",title:"Strike-through",state:()=>this.queryState("strikeThrough"),result:()=>this.exec("strikeThrough")},heading1:{icon:"<b>H<sub>1</sub></b>",title:"Heading 1",block:"h1",state:()=>this.queryBlockState("h1"),result:()=>this.exec("formatBlock","<h1>")},heading2:{icon:"<b>H<sub>2</sub></b>",title:"Heading 2",state:()=>this.queryBlockState("h2"),result:()=>this.exec("formatBlock","<h2>")},paragraph:{icon:"&#182;",title:"Paragraph",state:()=>this.queryBlockState("p"),result:()=>this.exec("formatBlock","<p>")},quote:{icon:"&#8220; &#8221;",title:"Quote",state:()=>this.queryBlockState("blockquote"),result:()=>this.exec("formatBlock","<blockquote>")},code:{icon:"&lt;/&gt;",title:"Code",state:()=>this.queryBlockState("pre"),result:()=>this.exec("formatBlock","<pre>")},olist:{icon:"&#35;",title:"Ordered List",result:()=>this.exec("insertOrderedList")},ulist:{icon:"&#8226;",title:"Unordered List",result:()=>this.exec("insertUnorderedList")},line:{icon:"&#8213;",title:"Horizontal Line",result:()=>this.exec("insertHorizontalRule")},link:{icon:"&#128279;",title:"Link",result:()=>{const t=window.prompt("Enter the link URL");return t&&this.exec("createLink",t),!0}},image:{icon:"&#128247;",title:"Image",result:()=>{var t=window.prompt("Enter the image URL");return t&&this.exec("insertImage",t),!0}}};get value(){return this.content.innerHTML}set value(t){this.content.innerHTML=t,this.content.focus(),this.change()}constructor(t,e={}){this.parent="string"==typeof t?document.querySelector(t):t;for(const t in this.defaultSettings)this.settings[t]=e[t]??this.defaultSettings[t];const s=this.create("div",this.classes.editor);this.settings.className&&s.classList.add(this.settings.className);const i=this.create("div",this.classes.actionbar);i.tabIndex=-1,s.append(i),this.settings.actions.forEach((t=>{if(void 0!==this.defaultActions[t]){const e=this.create("button",this.classes.button);this.defaultActions[t].button=e,e.innerHTML=this.defaultActions[t].icon,e.title=this.defaultActions[t].title,e.tabIndex=-1,i.append(e),e.addEventListener("click",(()=>{const e=this.defaultActions[t].result();return this.checkStates(),this.content.focus(),e}))}})),this.content=this.create("div",this.classes.content),this.content.contentEditable="true",this.content.addEventListener("mousedown",(()=>{this.checkStates()})),this.content.addEventListener("input",(t=>{this.change()})),this.exec("defaultParagraphSeparator",this.settings.separator),this.settings.styleWithCSS&&this.exec("styleWithCSS"),s.append(this.content),this.settings.input&&(this.input=this.create("input"),this.input.type="hidden",this.input.name=this.settings.input,s.append(this.input)),this.parent.append(s)}change(){this.content.firstChild&&this.content.firstChild.nodeType===Node.TEXT_NODE?this.exec("formatBlock","<"+this.settings.separator+">"):"<br>"===this.content.innerHTML&&(this.content.innerHTML=""),this.settings.onChange&&this.settings.onChange(this.content.innerHTML),this.input&&(this.input.value=this.content.innerHTML),this.checkStates()}create(t,e=null){const s=document.createElement(t);return e&&(s.className=e),s}exec(t,e=null){return setTimeout((()=>{document.execCommand(t,!1,e)}),0),!0}queryState(t){return document.queryCommandState(t)}queryBlockState(t){return document.queryCommandValue("formatBlock").toLowerCase()==t.toLowerCase()}checkStates(){setTimeout((()=>{this.settings.actions.forEach((t=>{void 0!==this.defaultActions[t]&&void 0!==this.defaultActions[t].state&&(this.defaultActions[t].state()?this.defaultActions[t].button.classList.add(this.classes.selected):this.defaultActions[t].button.classList.remove(this.classes.selected))}))}),1)}}